const fs = require('fs');
const path = require('path');

function scanDirectory(dirPath, basePath = '') {
  const items = fs.readdirSync(dirPath, { withFileTypes: true });
  const files = {};

  items.forEach(item => {
    if (item.name.startsWith('.')) return; // Skip hidden files

    const itemPath = path.join(dirPath, item.name);
    const relativePath = path.join(basePath, item.name);

    if (item.isFile() && item.name.endsWith('.md')) {
      files[item.name] = `/resources/recipes/${relativePath}`;
    }
  });

  return files;
}

// Generate the file structure for recipes only
const recipesPath = path.join(__dirname, '..', 'resources', 'recipes');
const recipes = scanDirectory(recipesPath);

// Create the output
const output = `// This file is auto-generated by scripts/generate-file-structure.js
// Do not edit manually - run 'npm run generate-files' to update

export const fileStructure = {
  recipes: ${JSON.stringify(recipes, null, 4).replace(/^/gm, '  ').trim()}
};

export const defaultExpandedFolders = ['recipes'];
`;

// Write to file
const outputPath = path.join(__dirname, '..', 'src', 'fileStructure.js');
fs.writeFileSync(outputPath, output);

console.log('File structure generated successfully');
console.log(`  Found ${Object.keys(recipes).length} recipes`);
